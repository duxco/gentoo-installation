
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Gentoo installation using Measured Boot, Secure Boot, Full Disk Encryption, RAID and offering a rescue system based on customised SystemRescueCD">
      
      
        <meta name="author" content="David Sardari">
      
      
        <link rel="canonical" href="https://duxsco.github.io/gentoo-installation/">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.6">
    
    
      
        <title>Gentoo Linux Installation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.4a0965b7.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#11-disclaimer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Gentoo Linux Installation" class="md-header__button md-logo" aria-label="Gentoo Linux Installation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Gentoo Linux Installation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1. Introduction
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/duxsco/gentoo-installation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    duxsco/gentoo-installation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Gentoo Linux Installation" class="md-nav__button md-logo" aria-label="Gentoo Linux Installation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Gentoo Linux Installation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/duxsco/gentoo-installation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    duxsco/gentoo-installation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1. Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        1. Introduction
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#11-disclaimer" class="md-nav__link">
    1.1. Disclaimer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-technologies" class="md-nav__link">
    1.2. Technologies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-ssh-connectivity" class="md-nav__link">
    1.3. SSH Connectivity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-disk-layout" class="md-nav__link">
    1.4. Disk Layout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15-luks-key-slots" class="md-nav__link">
    1.5. LUKS Key Slots
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="live-cd_environment/" class="md-nav__link">
        2. Live-CD Environment
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="disk_setup/" class="md-nav__link">
        3. Disk Setup
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="rescue_system/" class="md-nav__link">
        4. Rescue System
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="chrooting/" class="md-nav__link">
        5. Chrooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="system_setup/" class="md-nav__link">
        6. System Setup
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="boot_setup/" class="md-nav__link">
        7. Boot Setup
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="cleanup_and_reboot/" class="md-nav__link">
        8. Cleanup And Reboot
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="post-boot_configuration/" class="md-nav__link">
        9. Post-Boot Configuration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="optional_steps/" class="md-nav__link">
        10. Optional Steps
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="other_gentoo_linux_repos/" class="md-nav__link">
        11. Other Gentoo Linux Repos
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#11-disclaimer" class="md-nav__link">
    1.1. Disclaimer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-technologies" class="md-nav__link">
    1.2. Technologies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-ssh-connectivity" class="md-nav__link">
    1.3. SSH Connectivity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-disk-layout" class="md-nav__link">
    1.4. Disk Layout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15-luks-key-slots" class="md-nav__link">
    1.5. LUKS Key Slots
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/duxsco/gentoo-installation/blob/main/docs/index.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>1. Introduction</h1>

<h2 id="11-disclaimer">1.1. Disclaimer</h2>
<p>⚠ <strong>Don't blindly copy&amp;paste the commands! Understand what you are going to do and adjust commands if required!</strong> I point this out, even though it should go without saying... ⚠</p>
<p>⚠ The installation guide builds heavily on <code>Secure Boot</code> and requires TPM 2.0 for <code>Measured Boot</code>. Make sure that the system is in <code>Setup Mode</code> in order to be able to add your custom <code>Secure Boot</code> keys. You can, however, boot without <code>Setup Mode</code> and import the <code>Secure Boot</code> keys later on depending on the hardware in use (<a href="#installation-of-secure-boot-files-via-uefi-firmware-settings">link</a>). ⚠</p>
<h2 id="12-technologies">1.2. Technologies</h2>
<p>The following installation guide results in a system that is/uses:</p>
<ul>
<li><strong>Secure Boot</strong>: EFI binary/binaries in ESP(s) are Secure Boot signed.</li>
<li><strong>Measured Boot</strong>: All files in <code>/boot</code>, e.g. grub.cfg, initramfs, kernel, are GnuPG signed. Furthermore, <a href="https://wiki.archlinux.org/title/Trusted_Platform_Module#systemd-cryptenroll">systemd-cryptenroll</a> or <a href="https://github.com/latchset/clevis">clevis</a> is used to automatically decrypt LUKS volumes. You can secure the use of <code>systemd-cryptenroll</code> with a pin, though.</li>
<li><strong>Fully encrypted</strong>: Except ESP(s) and <code>/boot</code>, all partitions are LUKS encrypted.</li>
<li><strong>RAID</strong>: mdadm and BTRFS based RAID are used wherever it makes sense if the number of disks is &gt;= 2.</li>
<li><strong>Rescue system</strong> based on a <strong>customised SystemRescueCD</strong> that provides the <code>chroot.sh</code> script to conveniently chroot into your Gentoo installation.</li>
</ul>
<h2 id="13-ssh-connectivity">1.3. SSH Connectivity</h2>
<p>After completion of this installation guide, SSH connections will be possible via SSH public key authentication to the:</p>
<ul>
<li>Gentoo Linux system: <code>ssh -p 50022 david@&lt;IP address&gt;</code></li>
<li>Rescue system: <code>ssh -p 50023 root@&lt;IP address&gt;</code></li>
</ul>
<p>Both boot options are available in GRUB's boot menu.</p>
<h2 id="14-disk-layout">1.4. Disk Layout</h2>
<p>ESPs each with their own EFI entry are created one for each disk. Alternatively, you can store the ESP on multiple removable drives. This scenario won't be outlined in the following codeblocks. You just need to think of <code>1. EFI System Partition</code> missing in below scenarios.</p>
<p>Except for ESP, BTRFS/MDADM RAID 1 is used for all other partitions with RAID 5, RAID 6 and RAID 10 being further options for <code>swap</code>.</p>
<ul>
<li>Single disk:</li>
</ul>
<pre><code>PC∕Laptop
└── ∕dev∕sda
    ├── 1. EFI System Partition
    ├── 2. Btrfs (single)
    │   └── /boot
    ├── 3. LUKS
    │   └── Btrfs (single)
    │       └── rescue
    ├── 4. LUKS
    │   └── SWAP
    └── 5. LUKS (&quot;system&quot; partition)
        └── Btrfs (single)
            └── subvolumes
                ├── @binpkgs
                ├── @distfiles
                ├── @home
                ├── @ebuilds
                └── @root
</code></pre>
<ul>
<li>Two disks:</li>
</ul>
<pre><code>PC∕Laptop──────────────────────────┐
└── ∕dev∕sda                       └── ∕dev∕sdb
    ├── 1. EFI System Partition        ├── 1. EFI System Partition
    ├── 2. Btrfs raid1                 ├── 2. Btrfs raid1
    │   └── /boot                      │   └── /boot
    ├── 3. MDADM RAID 1                ├── 3. MDADM RAID 1
    │   └── LUKS                       │   └── LUKS
    │       └── Btrfs                  │       └── Btrfs
    │           └── rescue             │           └── rescue
    ├── 4. LUKS                        ├── 4. LUKS
    │   └── MDADM RAID 1               │   └── MDADM RAID 1
    │       └── SWAP                   │       └── SWAP
    └── 5. LUKS (&quot;system&quot; partition)   └── 5. LUKS (&quot;system&quot; partition)
        └── BTRFS raid1                    └── BTRFS raid1
            └── subvolume                      └── subvolume
                ├── @binpkgs                       ├── @binpkgs
                ├── @distfiles                     ├── @distfiles
                ├── @home                          ├── @home
                ├── @ebuilds                       ├── @ebuilds
                └── @root                          └── @root
</code></pre>
<ul>
<li>Three disks:</li>
</ul>
<pre><code>PC∕Laptop──────────────────────────┬──────────────────────────────────┐
└── ∕dev∕sda                       └── ∕dev∕sdb                       └── ∕dev∕sdc
    ├── 1. EFI System Partition        ├── 1. EFI System Partition        ├── 1. EFI System Partition
    ├── 2. Btrfs raid1c3               ├── 2. Btrfs raid1c3               ├── 2. Btrfs raid1c3
    │   └── /boot                      │   └── /boot                      │   └── /boot
    ├── 3. MDADM RAID 1                ├── 3. MDADM RAID 1                ├── 3. MDADM RAID 1
    │   └── LUKS                       │   └── LUKS                       │   └── LUKS
    │       └── Btrfs                  │       └── Btrfs                  │       └── Btrfs
    │           └── rescue             │           └── rescue             │           └── rescue
    ├── 4. LUKS                        ├── 4. LUKS                        ├── 4. LUKS
    │   └── MDADM RAID 1|5             │   └── MDADM RAID 1|5             │   └── MDADM RAID 1|5
    │       └── SWAP                   │       └── SWAP                   │       └── SWAP
    └── 5. LUKS (&quot;system&quot; partition)   └── 5. LUKS (&quot;system&quot; partition)   └── 5. LUKS (&quot;system&quot; partition)
        └── BTRFS raid1c3                  └── BTRFS raid1c3                  └── BTRFS raid1c3
            └── subvolume                      └── subvolume                      └── subvolume
                ├── @binpkgs                       ├── @binpkgs                       ├── @binpkgs
                ├── @distfiles                     ├── @distfiles                     ├── @distfiles
                ├── @home                          ├── @home                          ├── @home
                ├── @ebuilds                       ├── @ebuilds                       ├── @ebuilds
                └── @root                          └── @root                          └── @root
</code></pre>
<ul>
<li>Four disks:</li>
</ul>
<pre><code>PC∕Laptop──────────────────────────┬──────────────────────────────────┬──────────────────────────────────┐
└── ∕dev∕sda                       └── ∕dev∕sdb                       └── ∕dev∕sdc                       └── ∕dev∕sdd
    ├── 1. EFI System Partition        ├── 1. EFI System Partition        ├── 1. EFI System Partition        ├── 1. EFI System Partition
    ├── 2. Btrfs raid1c4               ├── 2. Btrfs raid1c4               ├── 2. Btrfs raid1c4               ├── 2. Btrfs raid1c4
    │   └── /boot                      │   └── /boot                      │   └── /boot                      │   └── /boot
    ├── 3. MDADM RAID 1                ├── 3. MDADM RAID 1                ├── 3. MDADM RAID 1                ├── 3. MDADM RAID 1
    │   └── LUKS                       │   └── LUKS                       │   └── LUKS                       │   └── LUKS
    │       └── Btrfs                  │       └── Btrfs                  │       └── Btrfs                  │       └── Btrfs
    │           └── rescue             │           └── rescue             │           └── rescue             │           └── rescue
    ├── 4. LUKS                        ├── 4. LUKS                        ├── 4. LUKS                        ├── 4. LUKS
    │   └── MDADM RAID 1|5|6|10        │   └── MDADM RAID 1|5|6|10        │   └── MDADM RAID 1|5|6|10        │   └── MDADM RAID 1|5|6|10
    │       └── SWAP                   │       └── SWAP                   │       └── SWAP                   │       └── SWAP
    └── 5. LUKS (&quot;system&quot; partition)   └── 5. LUKS (&quot;system&quot; partition)   └── 5. LUKS (&quot;system&quot; partition)   └── 5. LUKS (&quot;system&quot; partition)
        └── BTRFS raid1c4                  └── BTRFS raid1c4                  └── BTRFS raid1c4                  └── BTRFS raid1c4
            └── subvolume                      └── subvolume                      └── subvolume                      └── subvolume
                ├── @binpkgs                       ├── @binpkgs                       ├── @binpkgs                       ├── @binpkgs
                ├── @distfiles                     ├── @distfiles                     ├── @distfiles                     ├── @distfiles
                ├── @home                          ├── @home                          ├── @home                          ├── @home
                ├── @ebuilds                       ├── @ebuilds                       ├── @ebuilds                       ├── @ebuilds
                └── @root                          └── @root                          └── @root                          └── @root
</code></pre>
<ul>
<li>More disks can be used (see: <code>man mkfs.btrfs | sed -n '/^PROFILES$/,/^[[:space:]]*└/p'</code>). RAID 10 is only available to setups with an even number of disks.</li>
</ul>
<h2 id="15-luks-key-slots">1.5. LUKS Key Slots</h2>
<p>On the <code>rescue</code> partition, LUKS key slots are set as follows:</p>
<ul>
<li>0: Rescue password</li>
</ul>
<p>On all other LUKS volumes, LUKS key slots are set as follows:</p>
<ul>
<li>0: Fallback password for emergency</li>
<li>1: Measured Boot<ul>
<li>Option A: TPM 2.0 with optional pin to unlock with <a href="https://wiki.archlinux.org/title/Trusted_Platform_Module#systemd-cryptenroll">systemd-cryptenroll</a></li>
<li>Option B: <a href="https://github.com/latchset/clevis#pin-shamir-secret-sharing">Shamir Secret Sharing</a> combining <a href="https://github.com/latchset/clevis#pin-tpm2">TPM2</a> and <a href="https://github.com/latchset/clevis#pin-tang">Tang</a> pin (<a href="https://github.com/latchset/tang">Tang project</a>) to automatically unlock with Clevis</li>
</ul>
</li>
</ul>
<p>The following steps are basically those in <a href="https://wiki.gentoo.org/wiki/Handbook:AMD64/Full/Installation">the official Gentoo Linux installation handbook</a> with some customisations added.</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
      
        
        <a href="live-cd_environment/" class="md-footer__link md-footer__link--next" aria-label="Next: 2. Live-CD Environment" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              2. Live-CD Environment
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.85cb4492.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.a877e258.min.js"></script>
      
    
  </body>
</html>